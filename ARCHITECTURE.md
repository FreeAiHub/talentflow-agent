# ARCHITECTURE.md: Модульная Архитектура TalentFlow Agent

## 1. Обзор Системы

**TalentFlow Agent** — это высокомодульный AI-агент, разработанный для автоматизации лидогенерации и персонализированных откликов на вакансии. Архитектура построена на принципе **слабой связанности** (loose coupling) и **микросервисного подхода**, что обеспечивает гибкость, масштабируемость и возможность легкой замены отдельных компонентов (например, LLM-провайдера или парсера).

Ключевым элементом является **AI-Ядро**, которое выступает в роли интеллектуального оркестратора, управляющего процессом анализа и генерации.

## 2. Ключевые Модули

Система состоит из четырех основных функциональных блоков, каждый из которых выполняет свою специализированную задачу.

| Модуль | Назначение | Технологический Стек (Пример) |
| :--- | :--- | :--- |
| **A. Модуль Парсинга** | Автоматический сбор и фильтрация данных о вакансиях с целевых платформ. | Python (FastAPI), библиотеки для парсинга (BeautifulSoup, JobSpy), асинхронные запросы (aiohttp). |
| **B. AI-Ядро (Анализ и Генерация)** | Интеллектуальный центр для обработки текста, сопоставления профилей и создания экспертных откликов. | LLM (GPT-4o, Claude 3.5), RAG-система (Vector DB), Prompt Engineering. |
| **C. Модуль Взаимодействия** | Автоматизация исходящей коммуникации (отправка откликов, планирование встреч). | Python, API-интеграции (Calendly, Email/Slack API), Webhooks. |
| **D. Модуль Управления и Аналитики** | Хранение данных, логирование, мониторинг и предоставление пользовательского интерфейса. | PostgreSQL/SQLite, FastAPI/Flask, Docker, Grafana/Prometheus. |

## 3. Детализация AI-Ядра

AI-Ядро является сердцем системы и реализует **двухэтапный процесс** для обеспечения высокого качества и персонализации откликов.

### 3.1. Двухэтапный Анализ Вакансии

1.  **Этап Анализа (Extraction):**
    *   **Цель:** Извлечение структурированной информации из неструктурированного текста вакансии.
    *   **Выход:** JSON-структура, содержащая:
        *   **Ключевые Проблемы (Pain Points):** 3-5 основных задач, которые компания решает наймом.
        *   **KPI (Key Performance Indicators):** Метрики успеха, ожидаемые от кандидата.
        *   **Требуемые Технологии:** Список ключевых навыков и фреймворков.
2.  **Этап Генерации (Synthesis):**
    *   **Цель:** Создание персонализированного отклика, демонстрирующего понимание проблем и предлагающего конкретное решение.
    *   **Механизм:** Использует результаты Этапа Анализа и контекст из **Базы Знаний (RAG)** для формирования текста, который звучит как от эксперта.

### 3.2. База Знаний (RAG)

Для повышения экспертности и снижения галлюцинаций используется архитектура **Retrieval-Augmented Generation (RAG)**.
*   **Векторная База Данных:** Хранит эмбеддинги (embeddings) базы резюме, успешных кейсов и профилей специалистов.
*   **Функция:** Перед генерацией ответа, система извлекает наиболее релевантные фрагменты из базы знаний, чтобы обогатить контекст LLM.

## 4. Схема Взаимодействия (Data Flow)

1.  **Парсер** находит новую вакансию.
2.  **AI-Ядро** получает текст вакансии.
3.  **AI-Ядро** (Этап 1) анализирует текст и извлекает KPI/Pain Points.
4.  **AI-Ядро** (RAG) извлекает релевантный профиль специалиста (архетип) и кейсы.
5.  **AI-Ядро** (Этап 2) генерирует персонализированный отклик и CTA (ссылку на встречу).
6.  **Модуль Взаимодействия** отправляет отклик и создает запись о лиде в **Модуле Управления**.
7.  **Модуль Управления** уведомляет пользователя о новом лиде и отслеживает статус.

## 5. Принципы Разработки

*   **Openness:** Проект открыт для критики и обсуждения, что обеспечивает постоянное улучшение.
*   **Quality-First:** Фокус на качестве отклика, а не на массовой рассылке.
*   **Modularity:** Возможность легкой замены LLM, парсеров и БД без изменения основной логики.
*   **Data-Driven:** Использование A/B-тестирования и аналитики для принятия решений о развитии.
